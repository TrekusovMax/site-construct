import{k as v,a as y,l as E,r as u,j as e,F as S,n as C,Q as P}from"./index-c322cabe.js";import{I as b}from"./input-578891f6.js";import{L as g}from"./label-04ecb74d.js";const U="/site-construct/assets/user_profile_icon-4a1149bf.png",$="profile_x8JZ",I="profile__container_QB6-",V="profile__btn_container_evU4",O="profile__check_btn_z1Ea",w="profile__edit_btn_CqX6",A="profile__img_4W4A",F="profile__disabled_user_data_container_i3Mb",M="profile__disabled_user_data_MXe-",T="profile__enable_form_container_p0HS",z="profile__input_container_74A5",D="profile__input_container_label_h3SU",a={profile:$,profile__container:I,profile__btn_container:V,profile__check_btn:O,profile__edit_btn:w,profile__img:A,profile__disabled_user_data_container:F,profile__disabled_user_data:M,profile__enable_form_container:T,profile__input_container:z,profile__input_container_label:D},L=o=>{const s={name:{message:""},lastname:{message:""},email:{message:""}};o.name===""&&(s.name.message="Поле не должно быть пустым"),o.lastname===""&&(s.lastname.message="Поле не должно быть пустым"),o.email.match(/^[^ ]+@[^ ]+\.[a-z]{2,3}$/)||(s.email.message="Email не валиден");for(const m of Object.keys(s))if(s[m].message!=="")return s;return{}},Q=()=>{const[o]=v(),s=y(E),{accessToken:m}=s,_=localStorage.getItem("fullName"),h=localStorage.getItem("email"),n={name:_?_.split(" ")[0]:"",lastname:_?_.split(" ")[1]:"",email:h||""},[p,x]=u.useState(!1),[l,j]=u.useState({}),[r,N]=u.useState({name:n.name,lastname:n.lastname,email:n.email}),k=async()=>{if(!p)x(t=>!t);else{x(i=>!i);const t=r.email,d=`${r.name} ${r.lastname}`,c=await o({email:t,idToken:m,displayName:d,returnSecureToken:!0});if("error"in c){const i=c.error;P.error(`Ошибка! code: ${i.data.error.code}, message: ${i.data.error.message}`)}}},f=t=>{const d={...r,[t.target.name]:t.target.value},c=L(d);j(c),N(i=>({...i,[t.target.name]:t.target.value}))};return e.jsx("div",{className:a.profile,children:e.jsxs("div",{className:a.profile__container,children:[e.jsx("button",{className:a.profile__btn_container,onClick:()=>k(),disabled:Object.keys(l).length!==0,style:Object.keys(l).length!==0?{opacity:"0.2",cursor:"auto"}:void 0,"data-testid":"user-profile-main-btn",children:p?e.jsx(S,{title:"Отправить",className:a.profile__check_btn}):e.jsx(C,{title:"Редактировать",className:a.profile__edit_btn})}),e.jsx("img",{src:U,className:a.profile__img,alt:"icon"}),p?e.jsxs("form",{className:a.profile__enable_form_container,children:[e.jsxs("div",{className:a.profile__input_container,children:[e.jsx(g,{forValue:"form_name",label:"Имя",className:a.profile__input_container_label}),e.jsx(b,{error:l.name&&l.name.message,type:"text",id:"form_name",name:"name",onChange:t=>f(t),value:r.name,placeholder:"Имя",style:{color:"black",width:"100%"}})]}),e.jsxs("div",{className:a.profile__input_container,children:[e.jsx(g,{forValue:"form_lastname",label:"Фамилия",className:a.profile__input_container_label}),e.jsx(b,{error:l.lastname&&l.lastname.message,type:"text",id:"form_lastname",name:"lastname",onChange:t=>f(t),value:r.lastname,placeholder:"Фамилия",style:{color:"black",width:"100%"}})]}),e.jsxs("div",{className:a.profile__input_container,children:[e.jsx(g,{forValue:"form_email",label:"Email",className:a.profile__input_container_label}),e.jsx(b,{error:l.email&&l.email.message,type:"email",id:"form_email",name:"email",onChange:t=>f(t),value:r.email,placeholder:"Email",style:{color:"black",width:"100%"}})]})]}):e.jsxs("div",{className:a.profile__disabled_user_data_container,children:[e.jsx("span",{className:a.profile__disabled_user_data,children:`${n.name} ${n.lastname}`}),e.jsx("span",{className:a["profile__disabled-user-data"],children:n.email})]})]})})},B=()=>e.jsx(Q,{});export{B as default};
