import{r as c,s as T,u as A,j as s,B as F,p as I,Q as C}from"./index-c322cabe.js";import{L as d}from"./label-04ecb74d.js";import{I as g}from"./input-578891f6.js";import{a as R}from"./errorCodes-6eb2ab82.js";const O=e=>{const a={name:{message:""},lastname:{message:""},email:{message:""},password:{message:""},confirmPassword:{message:""}},{name:p,lastname:x,email:f,password:u,confirmPassword:n}=e;p===""&&(a.name.message="Поле не должно быть пустым"),x===""&&(a.lastname.message="Поле не должно быть пустым"),f===""&&(a.email.message="Поле не должно быть пустым"),u===""&&(a.password.message="Поле не должно быть пустым"),n===""&&(a.confirmPassword.message="Поле не должно быть пустым"),u!==n&&(a.confirmPassword.message="Пароли не совпадают"),f.match(/^[^ ]+@[^ ]+\.[a-z]{2,3}$/)||(a.email.message="Email не валиден");for(const m of Object.keys(a))if(a[m].message!=="")return a;return{}},z="container_R-KA",M="form_-Zru",U="block_Bs1x",H="btn_normal_6YeS",J="btn_error_0Tiz",K="login_7CvJ",Q="login_link_6BjT",t={container:z,form:M,block:U,btn_normal:H,btn_error:J,login:K,login_link:Q},W=()=>{const[e,a]=c.useState({}),[p,x]=c.useState(""),[f,u]=c.useState(""),[n,m]=c.useState(!0),[E,{isLoading:D}]=T(),L=A();c.useEffect(()=>{for(const r in e)e[r].message!==""?m(!1):m(!0)},[e]);const i=r=>{let o={...e,[r.target.name]:{message:""}};r.target.name==="password"&&(x(r.target.value),r.target.value!==f?o={...e,password:{message:"Пароли не совпадают"},confirmPassword:{message:"Пароли не совпадают"}}:o={...e,password:{message:""},confirmPassword:{message:""}}),r.target.name==="confirmPassword"&&(u(r.target.value),r.target.value!==p?o={...e,password:{message:"Пароли не совпадают"},confirmPassword:{message:"Пароли не совпадают"}}:o={...e,password:{message:""},confirmPassword:{message:""}}),a(o)},$=async r=>{var P,k,S,y,N;a({}),r.preventDefault();const o=new FormData(r.currentTarget),j=((P=o.get("name"))==null?void 0:P.toString())||"",_=((k=o.get("lastname"))==null?void 0:k.toString())||"",b=((S=o.get("email"))==null?void 0:S.toString())||"",h=((y=o.get("password"))==null?void 0:y.toString())||"",B=((N=o.get("confirmPassword"))==null?void 0:N.toString())||"",v=O({name:j,lastname:_,email:b,password:h,confirmPassword:B});if(a(v),Object.keys(v).length===0){const V=await E({displayName:j+" "+_,email:b,password:h,returnSecureToken:!0});if("error"in V){m(!1);const l=V.error,w=l.data.error.message.split(" ")[0];if(C.error(`Ошибка! code: ${l.data.error.code}, message: ${l.data.error.message}`),w.match(/EMAIL/g))a({email:{message:R[w]}});else if(w.match(/PASSWORD/g)){a({password:{message:R[w]}});return}else C.error(`Ошибка! code: ${l.data.error.code}, message: ${l.data.error.message}`)}else a({}),L("/")}};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:t.container,children:[s.jsx("h1",{children:"Регистрация"}),s.jsxs("form",{onSubmit:$,className:t.form,children:[s.jsxs("div",{className:t.block,children:[s.jsx(d,{forValue:"form_name",label:"Имя"}),s.jsx("div",{children:s.jsx(g,{error:e.name&&e.name.message,type:"text",id:"form_name",name:"name",defaultValue:"",onChange:i})})]}),s.jsxs("div",{className:t.block,children:[s.jsx(d,{forValue:"form_lastname",label:"Фамилия"}),s.jsx("div",{children:s.jsx(g,{error:e.lastname&&e.lastname.message,type:"text",id:"form_lastname",name:"lastname",defaultValue:"",onChange:i})})]}),s.jsxs("div",{className:t.block,children:[s.jsx(d,{forValue:"form_email",label:"Email"}),s.jsx("div",{children:s.jsx(g,{error:e.email&&e.email.message,type:"email",id:"form_email",name:"email",defaultValue:"",onChange:i})})]}),s.jsxs("div",{className:t.block,children:[s.jsx(d,{forValue:"form_password",label:"Пароль"}),s.jsx("div",{children:s.jsx(g,{error:e.password&&e.password.message,id:"form_password",type:"password",name:"password",defaultValue:"",onChange:i})})]}),s.jsxs("div",{className:t.block,children:[s.jsx(d,{forValue:"form_confirm_password",label:"Подтверждение пароля"}),s.jsx("div",{children:s.jsx(g,{error:e.confirmPassword&&e.confirmPassword.message,id:"form_confirm_password",type:"password",name:"confirmPassword",defaultValue:"",onChange:i})})]}),s.jsx(F,{className:n?t.btn_normal:t.btn_error,disabled:!n,type:"submit",isLoading:D,children:"Регистрация"}),s.jsx("br",{}),s.jsx("div",{className:t.login,children:s.jsx(I,{className:t.login_link,to:"/login",children:"Войти"})})]})]})})},ss=()=>s.jsx(W,{});export{ss as default};
