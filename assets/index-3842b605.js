import{r as m,u as y,o as E,j as e,B as A,p as b,Q as k,a as D,q as R,N as C}from"./index-1bd218be.js";import{L as w}from"./label-515e9e47.js";import{I as N}from"./input-e168b4ca.js";import{e as g}from"./errorCodes-6eb2ab82.js";const I=r=>{const s={email:{message:""},password:{message:""}},{email:n,password:i}=r;n===""&&(s.email.message="Поле email не должно быть пустым!"),i===""&&(s.password.message="Поле пароля не должно быть пустым!"),n.match(/^[^ ]+@[^ ]+\.[a-z]{2,3}$/)||(s.email.message="Email не валиден!");for(const l of Object.keys(s))if(s[l].message!=="")return s;return{}},V="container_MEa8",T="form_tRQK",F="block_NNGz",H="btn_normal_YdNH",M="btn_error_1Rqi",O="register_xHtA",$="register_link_aJr6",a={container:V,form:T,block:F,btn_normal:H,btn_error:M,register:O,register_link:$},q=()=>{const[r,s]=m.useState({}),[n,i]=m.useState(!0),l=y(),[v,{isLoading:L}]=E();m.useEffect(()=>{for(const t in r)r[t].message!==""?i(!1):i(!0)},[r]);const d=t=>{s({...r,[t.target.name]:{message:""}})},S=async t=>{var x,_;t.preventDefault(),s({});const f=new FormData(t.currentTarget),u=((x=f.get("email"))==null?void 0:x.toString())||"",p=((_=f.get("password"))==null?void 0:_.toString())||"",h=I({email:u,password:p});if(s(h),Object.keys(h).length===0){const j=await v({email:u,password:p,returnSecureToken:!0});if("error"in j){i(!1);const c=j.error,o=c.data.error.message.split(" ")[0];o.match(/EMAIL/g)?s({email:{message:g[o]}}):o.match(/PASSWORD/g)?s({password:{message:g[o]}}):o.match(/TRY_LATER/g)?k.error(g[o]):k.error(`Ошибка! code: ${c.data.error.code}, message: ${c.data.error.message}`)}else s({}),l("/")}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:a.container,children:[e.jsx("h1",{children:"Вход"}),e.jsxs("form",{onSubmit:S,className:a.form,children:[e.jsxs("div",{className:a.block,children:[e.jsx(w,{forValue:"form_email",label:"Email"}),e.jsx("div",{children:e.jsx(N,{error:r.email&&r.email.message,type:"email",id:"form_email",name:"email",defaultValue:"",onChange:d})})]}),e.jsxs("div",{className:a.block,children:[e.jsx(w,{forValue:"form_password",label:"Пароль"}),e.jsx("div",{children:e.jsx(N,{error:r.password&&r.password.message,id:"form_password",type:"password",name:"password",defaultValue:"",onChange:d})})]}),e.jsx(A,{isLoading:L,type:"submit",className:n?a.btn_normal:a.btn_error,disabled:!n,children:"Войти"}),e.jsx("br",{}),e.jsx("div",{className:a.register,children:e.jsx(b,{className:a.register_link,to:"/register",children:"Зарегистрироваться"})}),e.jsx("div",{className:a.register,children:e.jsx(b,{className:a.register_link,to:"/forgot-password",children:"Забыл пароль"})})]})]})})},J=()=>D(R)?e.jsx(C,{to:"/"}):e.jsx(q,{});export{J as default};
